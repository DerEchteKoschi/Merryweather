{% extends 'base.html.twig' %}

{% block title %}{{ 'slotbooking'|trans }}{% endblock %}

{% block javascripts %}
    {% if appConfig.mercureActive %}
    <script>
        function reloadList() {
            $.ajax("{{ path('app_slot_list') }}").done(function (response) {
                $('#slotlist').replaceWith(response);
            });
        }

        const eventSource = new EventSource("{{ mercure('booking')|escape('js') }}");
        eventSource.onmessage = reloadList;

        let status = 1;
        window.addEventListener("offline", () => {
            status = 0;
        });

        window.addEventListener("online", () => {
            if (status !== 1) {
                status = 1;
                reloadList();
            }
        });
    </script>
    {% endif %}
{% endblock %}

{% block body %}
{{ include('slot_booking/list.html.twig') }}
{% endblock %}
